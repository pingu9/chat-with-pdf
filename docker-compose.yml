version: '3.8'

services:
  fastapi:
    build: .
    ports:
      - "8000:8000"
    volumes:
      - .:/app
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    container_name: fastapi_service
    depends_on:
      - chromadb
    networks:
      - app-network

  streamlit:
    build: .
    ports:
      - "8501:8501"
    volumes:
      - .:/app
    container_name: streamlit_service
    depends_on:
      - fastapi
      - chromadb
    command: streamlit run app/streamlit_ui.py
    networks:
      - app-network

  chromadb:
    image: chromadb/chroma
    ports:
      - "8001:8001"
    container_name: chromadb_service
    networks:
      - app-network

networks:
  app-network:
    driver: bridge